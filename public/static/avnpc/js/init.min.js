eva.ready(function(){if($.browser.msie&&(($.browser.version=="6.0"&&!$.support.style)||$.browser.version=="7.0")){jQuery.fx.off=true}$("a[rel=external]").live("click",function(){$(this).attr("target","_blank")});$("span[data-url-wrap]").each(function(){$(this).wrapInner('<a href="'+$(this).attr("data-url-wrap")+'"></a>')});eva.loader("http:////s7.addthis.com/js/300/addthis_widget.js#pubid=allovince",function(){});eva.loader("http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit",function(){});$(".agotime").each(function(){var c=$(this);c.html(moment(c.attr("datetime"),"YYYY-MM-DDTHH:mm:ss ZZ").fromNow())});if($("#blog pre>code")[0]){eva.loadcss(eva.assets(["/module/avnpc/js/github.css"]));eva.loader(eva.assets(["/module/avnpc/js/highlight.min.js"]),function(){hljs.tabReplace="    ";hljs.initHighlightingOnLoad()})}var b=$("#blog > article :header");if(b.length>4){eva.loader(eva.assets(["/module/avnpc/js/jquery.toc.min.js","/lib/js/jquery/jquery.jscrollpane.min.js"]),function(){var f=$('<div id="toc" class="typo typocn min"></div>').appendTo("body");f.toc({selectors:"h1,h2,h3,h4",container:"#blog",onHighlight:function(g){var h=$(g).position();f.data("jsp").scrollTo(0,h.top-200)},smoothScrolling:true});f.jScrollPane({});f.append('<span class="handler"><i class="icon-angle-left"></i></span>');var e=f.find(".handler");var d=function(){if(f.is(":animated")){return false}if(f.hasClass("min")){e.hide();f.animate({right:0},"fast",function(){f.toggleClass("min");e.find("i").toggleClass("icon-angle-left icon-angle-right");e.show()})}};var c=function(){if(f.is(":animated")){return false}if(!f.hasClass("min")){e.hide();f.animate({right:"-300px"},"fast",function(){f.toggleClass("min");e.find("i").toggleClass("icon-angle-left icon-angle-right");e.show()})}};e.on("click",function(){if(f.is(":animated")){return false}if(f.hasClass("min")){d()}else{c()}});if($(document).width()-1200>300){d()}})}eva.story();if($("#timeline-embed")[0]){var a=$("#timeline-embed");$("body").addClass("timeline");eva.loader(eva.assets(["/module/avnpc/timeline/js/storyjs-embed.js"]),function(){var f=550;var c=$(window).height()>f?$(window).height()-85:f;var e=a.html();e=eva.d("/proxy/spreadsheet");a.empty();var d={type:"timeline",width:"100%",height:c,start_at_end:true,debug:false,lang:"zh-cn",source:e,embed_id:"timeline-embed",js:eva.assets("/module/avnpc/timeline/js/timeline.min.js"),css:eva.assets("/module/avnpc/timeline/css/timeline.css")};createStoryJS(d)})}});eva.destruct=function(){};eva.story=function(){if(!$("#stories")[0]){return false}var a=function(){var d=10;var i=1;var b=$("#stories>.stories-wrap>.stories");var g=$("#stories .load-story");$("body").append('<div id="load-area"></div>');var c=$("#load-area");var e=[];var h=function(k){k.each(function(){var l=$(this);l.find(".agotime").each(function(){var m=$(this);m.html(moment(m.attr("datetime"),"YYYY-MM-DDTHH:mm:ss ZZ").fromNow())});if(l.hasClass("inited")){return true}if(l.hasClass("type-note")){l.find(">.content").jScrollPane({autoReinitialise:true})}l.addClass("inited");return true})};$(window).resize(function(){b.masonry({itemSelector:".item",columnWidth:$(window).width()>800?320:260,isAnimated:true}).masonry("reload")});b.imagesLoaded(function(){b.masonry({itemSelector:".item",columnWidth:$(window).width()>800?320:260,isAnimated:true});var k=b.find(".item:not(.inited)");h(k)});c.hide();function j(l,k){for(s=0;s<k.length;s++){thisEntry=k[s].toString();if(thisEntry==l){return true}}return false}var f=function(k){if(i>d){return false}var l=k.attr("href");if(j(l,e)){return false}k.addClass("disabled").html(" \uff08\uff1b^\u03c9^\uff09 \u6b63\u5728\u52aa\u529b\u8f7d\u5165...");e.push(l);c.load(l+" #stories>.stories-wrap",function(){var n=c.find(".load-story").attr("href");k.attr("href",n);var m=c.find(".stories-wrap>.stories>.item");c.imagesLoaded(function(){b.append(m).masonry("appended",m,true);h(b.find(".item:not(.inited)"));c.html("");k.removeClass("disabled").html("\u66f4\u591a")});i++});return false};$(window).scroll(function(){var n=$(document).height();var k=$(window).scrollTop();var l=$(window).height();var m=n-k-l;if(m<300){f(g)}})};eva.loader(eva.s(["/lib/js/jquery/jquery.masonry.js","/lib/js/jquery/jquery.mousewheel.js","/lib/js/jquery/jquery.jscrollpane.js"]),a)};eva.init(eva_config);
